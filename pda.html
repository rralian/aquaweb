<html>

<head>
  <title>Pool Controller</title>
  <script language="Javascript">

  function sendKey( key ) {
    fetch( '/key.cgi', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      },
      body: 'key=' + key
    } );
  }

  function init() {
    let statusMessage = '';

    const updateBody = str => {
      if ( str && str != statusMessage ) {
        statusMessage = str;
        document.getElementById('screen').innerHTML = str;
      }
      setTimeout(getBody(), 250);
    }
    const getBody = () => {
      fetch('/screen.cgi', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
        }
      }).then(res => res.text()).then(data => updateBody(data));
    };
    getBody();
  }
  </script>
</head>

<body onload="init()">
  <table>
    <tr>
      <td style="border:1px solid black;">
        <font size="+2">
<div id="screen">
<pre>SUN  3:25PM
105`     93`
<span style="background-color: #FFFF00"><b>
POOL MODE     ON</b></span>
POOL HEATER  OFF
SPA MODE     OFF
SPA HEATER   OFF
MENU
EQUIPMENT ON/OFF


</pre>
</div>
        </font>
      </td>
    </tr>
    <tr>
      <td>
        <table>
          <tr>
            <td align="left"><button onclick="sendKey('back');">Back</button</td> <td align="center"><button
                  onclick="sendKey('up');">Up</button></td>
            <td align="right"><button>&nbsp;</button></td>
          </tr>
          <tr>
            <td align="left">&nbsp;</td>
            <td align="center"><button onclick="sendKey('select');">Select</button></td>
            <td align="right">&nbsp;</td>
          </tr>
          <tr>
            <td align="left"><button onclick="sendKey('pgup');">1</button></td>
            <td align="center"><button onclick="sendKey('down');">Down</button></td>
            <td align="right"><button onclick="sendKey('pgdn');">2</button></td>
          </tr>
        </table>
  </table>
</body>

</html>
